<section class="the-grid">
    <div class="page-width">
        {% if section.settings.title != blank %}
            <h2>{{ section.settings.title }}</h2>
        {% endif %}
        <div class="grid product-grid grid--2-col-tablet-down grid--3-col-desktop">
            {% for block in section.blocks %}
                {% assign card_product = block.settings.card_product %}
                <div class="grid__item">
                    <div class="product-image is-relative">
                        <img src="{{ card_product.featured_media | img_url: '400x' }}" alt="{{ card_product.title }}" />
                        <span class="popup-trigger" style="top: {{ block.settings.topBottom }}%;left: {{ block.settings.leftRight }}%;">
                            <script type="json/javascript">{{ all_products[card_product] | json }}</script>
                            <svg width="22" height="22" viewBox="0 0 22 22" fill="none" xmlns="http://www.w3.org/2000/svg"> <circle cx="11" cy="11" r="11" fill="#F8F8F8" fill-opacity="0.9"/> <path d="M11.3457 7.04175V15.5033" stroke="black" stroke-width="1.5" stroke-linecap="square" stroke-linejoin="round"/> <path d="M7.11523 11.2725H15.5768" stroke="black" stroke-width="1.5" stroke-linecap="square" stroke-linejoin="round"/> </svg>
                        </span>
                    </div>
                </div>
            {% endfor %}
        </div>
    </div>
    <div class="pdp-popup-wrapper">
        <div class="pdp-popup">
            <span class="closepopup">
                <svg width="18" height="18" viewBox="0 0 18 18" fill="none" xmlns="http://www.w3.org/2000/svg"> <path d="M5.03784 4.94354L13.5231 13.4288" stroke="black" stroke-width="1.5" stroke-linecap="square" stroke-linejoin="round"/> <path d="M5.03784 13.4285L13.5231 4.94325" stroke="black" stroke-width="1.5" stroke-linecap="square" stroke-linejoin="round"/> </svg>
            </span>
            <div class="pdp-popup-content">
                <div class="pdp-popup-top is-flex is-align-end">
                    <div class="pdp-popup-image">
                        <img src="https://cdn.shopify.com/s/files/1/0661/1913/9380/files/popup-dummy.jpg?v=1724358332" alt="Product Name" />
                    </div>
                    <div class="pdp-product-detail">
                        <h4>Product Name</h4>
                        <div class="pdp-price">$0.0</div>
                        <div class="pdp-desc">
                            <p>Lorem Ipsum is simply dummy text of the printing and typesetting industry.</p>
                        </div>
                    </div>
                </div>
                <div class="popup-form">
                    <form id="addToCartForm">
                        <div id="productOptions"></div>
                        <input type="hidden" id="variantId" name="variant_id">
                        <button class="btn btn-primary" type="submit">Add to Cart <span class="btn-icon"><svg width="69" height="30" viewBox="0 0 69 30" fill="none" xmlns="http://www.w3.org/2000/svg"> <path d="M2.75879 13.1458L0.758789 13.1458L0.758789 17.1458L2.75879 17.1458L2.75879 13.1458ZM68.173 16.56C68.9541 15.779 68.9541 14.5127 68.173 13.7316L55.4451 1.00368C54.664 0.222633 53.3977 0.222633 52.6167 1.00368C51.8356 1.78473 51.8356 3.05106 52.6167 3.83211L63.9304 15.1458L52.6167 26.4595C51.8356 27.2406 51.8356 28.5069 52.6167 29.288C53.3977 30.069 54.664 30.069 55.4451 29.288L68.173 16.56ZM2.75879 17.1458L66.7588 17.1458L66.7588 13.1458L2.75879 13.1458L2.75879 17.1458Z" fill="black"/> </svg></span></button>
                    </form>
                </div>
            </div>
        </div>
    </div>
</section>
{% schema %}

{
    "name": "The Grid",
    "settings": [
        {
            "type": "text",
            "id":"title",
            "label": "Heading",
            "default": "Heading"
        }
    ],
    "blocks": [
        {
            "type": "product_card",
            "name": "Product",
            "settings": [
                {
                    "type": "product",
                    "label": "Select Product",
                    "id": "card_product"
                },
                {
                    "type": "header",
                    "content": "Popup Trigger Position"
                },
                {
                    "type": "range",
                    "label": "Top/Bottom",
                    "min": 0,
                    "max": 100,
                    "unit": "%",
                    "default": 40,
                    "id": "topBottom"
                },
                {
                    "type": "range",
                    "label": "Left/Right",
                    "min": 0,
                    "max": 100,
                    "unit": "%",
                    "default": 40,
                    "id": "leftRight"
                }
            ]
        }
    ],
    "presets": [
        {
            "name": "The Grid"
        }
    ]
}

{% endschema %}
